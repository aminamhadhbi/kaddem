pipeline {
    agent any
 //environment {
   //     MAVEN_HOME = tool name: 'Maven', type: 'Tool'
 //   }
    stages {
        stage('Checkout') {
            steps {
                // Récupérer le code depuis le référentiel Git
                git 'https://github.com/aminamhadhbi/kaddem.git'
            }
        }
 stage('Maven Clean') {
            steps {
                // Nettoyer le projet (mvn clean)
                sh 'mvn clean'
            }
        }

        stage('Maven Compile') {
            steps {
                // Compiler le projet (mvn compile)
                sh 'mvn compile'
            }
        }

    stage('SonarQube Analysis') {
            steps {
                    sh 'mvn sonar:sonar -Dsonar.login=admin -Dsonar.password=admin'
                }
          
        }

        stage('Build Artifact') {
            steps {
                    script {
                    // Set the Maven goals and options
                    def mavenGoals = 'clean package'
                    
                    // Run Maven to build the artifact using the predefined Maven tool
                    sh script: "${MAVEN_HOME}/bin/mvn ${mavenGoals}"
                }
            }
       
    }
    }
}

